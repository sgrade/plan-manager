---
alwaysApply: false
---
# Project management rules

## Purpose & application

Code changes are allowed in the following cases:
1. Aligned with the plan documented via Plan Manager MCP server
2. Deviations are discussed, reflected in the plan, and approved
3. Explicit user request to perform a task outside Plan Manager

## Work items and statuses
- Plan: documents major change; maps to MAJOR in semantic versioning; a collection of stories.
- Story: WHAT/WHY and acceptance (user-facing outcome); maps to MINOR; a collection of tasks.
- Task: HOW it gets done (implementation steps) for the AI agent; maps to PATCH. Each task should be a small, self-contained unit of work equivalent to a single Pull Request (PR) or Merge Request (MR).
- Statuses: apply to plans, stories, and tasks; primary progression is TODO → IN_PROGRESS → PENDING_REVIEW → DONE; side states: BLOCKED, DEFERRED.
- Dependencies: tasks/stories may block others.
- Priority: 0–5 (0 is highest).

## Development workflow
1. Planning:
   - The user can select an existing work item (Plan or Story) to review, or create a new one.
   - **Reviewing**: The user can review the stories in the current plan with `list_stories`. After selecting a story, they can review its tasks with `list_tasks`. This helps understand the full **Story Context** before committing to execution.
   - **Creating**: New stories are created with the `create_story` command. After a story is created, the user can direct the agent to create tasks for it.
   - The user always reviews the proposed/existing items and can `approve` or `change` them.
2. Execution (per-task): This follows a standard Pull Request (PR) workflow.
   - **Task Description (Pre-Execution Review)**: Before starting a task, the agent must propose a description of the work, including the objective and scope. This is equivalent to a PR description. The user must `approve` this before work begins.
   - **Implementation**: Upon approval, a task's status is set to `IN_PROGRESS` and the agent begins work.
   - **Code Review (Post-Execution Review)**: After completing the work, the agent submits the code for review, and the task's status is set to `PENDING_REVIEW`. The agent provides a summary of changes, similar to a changelog entry. The user reviews the changes.
     - If the user responds with `approve`, the work is merged and the task is marked as `DONE`.
     - If the user responds with `change`, the task's status is moved back to `IN_PROGRESS`, allowing the agent to make corrections and re-submit for review. This cycle repeats until the work is approved.
     - This review step is mandatory.
   - **Fast-Track (Optional)**: For simple or trusted tasks, the user can choose to skip the pre-execution review. See the `approve [item_index]` command.

## Commands (chat → actions)
- list_plans
  - Lists all available plans.
- create_plan [title] [description]
  - Creates a new plan.
- set_current_plan [plan_id]
  - Sets the currently active plan.
- list_stories
  - Lists all stories for the currently active plan. This is the primary way to get an overview of a plan.
- list_tasks
  - Lists all tasks for the currently active story. This is the primary way to see the work items within a story.
- create_story [title] [description]
  - Creates a new story in the current plan.
- approve [item_index]
  - Applies contextually. If `item_index` is omitted, it applies to the current item under review.
    - **Plan/Story Review**: Accepts the overall proposal. The agent will then proceed to the first task and request a pre-execution review.
    - **Fast-Track Plan Review**: If an `item_index` (e.g., `approve 1`) is provided during a plan review, it approves the overall plan AND bypasses the pre-execution review for the specified task, moving it directly to `IN_PROGRESS`.
    - **Pre-Execution Review**: Approves the task's description, authorizing the agent to begin implementation.
    - **Post-Execution Review**: Accepts and merges the code changes, marking the task as `DONE`.
- get_current
  - Provides a simple, unambiguous overview of the current context (plan, story, and task IDs).
- report
  - Provides a dynamic, user-friendly report on the current work item, including its status, a summary of its progress, and suggested next actions.
- change [instructions]
  - Used to edit the current or named item(s) by index or title. The agent can edit titles, descriptions, priorities, dependencies, and add/remove tasks.
  - If instructions are not provided, the agent will ask what should be changed.
  - After applying edits, the agent will print an updated summary for review.
